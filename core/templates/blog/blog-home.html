{% extends 'base.html' %}
{% load static %}
{% block content %}
  <!-- Page Content -->
  <div class="container pb-5 mb-3">
    <!-- Filters -->
    <ul class="nav nav-tabs nav-tabs-style-2 mb-4">
      <li class="nav-item">
        <a class="nav-link active" href="#" data-filter="*">همه&nbsp;<sup>{{total_posts}}</sup></a>
      </li>
      {% for cat in categories %}
        {% if cat.post_count > 0 %}
        <li class="nav-item">
          <a class="nav-link" href="{% url 'blog:category' cat_name=cat.name %}" data-filter=".{{ cat.name }}">{{ cat.name }}&nbsp;<sup>{{cat.post_count}}</sup></a>
        </li>
        {% endif %}
      {% endfor %}
    </ul>
    <!-- Grid -->
    <div class="isotope-grid filter-grid cols-3">
      <div class="gutter-sizer"></div>
      <div class="grid-sizer"></div>

      <!-- Post Item Begin -->
      {% for post in posts %}
        <div class="grid-item {% for cat in post.categories.all %} {{ cat }} {% endfor %} mb-30">
          <div class="portfolio-card">
            <a class="portfolio-thumb" href="{% url 'blog:blog-detail' name=post.title %}"><img src="{{ post.image.url }}" alt="Portfolio Thumbnail" /></a>
            <div class="portfolio-card-body">
              <div class="portfolio-meta">
                <span class="ml-3"><i class="fe-icon-user"></i>{{ post.photographer.get_full_name }}</span>
                <span class="ml-3"><i class="fe-icon-eye"></i>{{ post.counted_views }}</span>
                <a href="#"><i class="fe-icon-heart text-accent"></i>{{post.counted_likes}}</a>
              </div>
              <h5 class="portfolio-title"><a href="{% url 'blog:blog-detail' name=post.title %}">{{ post.title }}</a></h5>
              {% for cat in post.categories.all %}
                <a class="tag-link" href="{% url 'blog:category' cat_name=cat %}">{{ cat }}</a>
              {% endfor %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
      <!-- Post Item End -->
    <div class="pt-2">
      <!-- Pagination Begin -->
      <nav class="pagination">
        {% if posts.has_previous %}
          <a class="prev-btn" href="?page=1"><i class="fe-icon-chevron-right"></i>صفحه نخست</a>
          <a class="prev-btn" href="?page={{ posts.previous_page_number }}"><i class="fe-icon-chevron-right"></i>صفحه قبل</a>
        {% else %}
          <span class="prev-btn" href=""><i class="fe-icon-chevron-right"></i>صفحه نخست</span>
          <span class="prev-btn" href=""><i class="fe-icon-chevron-right"></i>صفحه قبل</span>
        {% endif %}

        <ul class="pages">
        {% for post in posts.paginator.page_range %}
          {% if posts.number == post %}
            <li class="d-none d-sm-inline-block active"><a href="?page={{post}}">{{post}}</a></li>
          {% else %}
            <li class="d-none d-sm-inline-block"><a href="?page={{post}}">{{post}}</a></li>
          {% endif %}
        {% endfor %}
        </ul>

        {% if posts.has_next %}
          <a class="next-btn" href="?page={{ posts.next_page_number }}">صفحه بعد<i class="fe-icon-chevron-left"></i></a>
          <a class="next-btn" href="?page={{ posts.paginator.num_pages }}">صفحه پایانی<i class="fe-icon-chevron-left"></i></a>
        {% else %}
          <span class="next-btn" href="">صفحه بعد<i class="fe-icon-chevron-left"></i></span>
          <span class="next-btn" href="">صفحه پایانی<i class="fe-icon-chevron-left"></i></span>
        {% endif %}
      </nav>
      <!-- Pagination Ends -->
    </div>
  </div>
{% endblock %}
